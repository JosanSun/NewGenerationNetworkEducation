define("common-jquery:widget/js/logic/text2audio/text2audio.es",function(n,e){"use strict";function t(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function n(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),u=n("common-jquery:widget/js/util/audio-list/audio-list.es"),o=function(){function n(e){var i=e.url,o=void 0===i?"//tts.baidu.com/text2audio?cuid=baiduid&lan=zh&ctp=1&pdt=311&spd=6&tex=":i,a=e.text,s=void 0===a?"":a,r=e.maxChunkSize,c=void 0===r?100:r,h=e.minChunkSize,d=void 0===h?20:h,l=e.onplay,f=void 0===l?function(){}:l,p=e.onpause,v=void 0===p?function(){}:p,m=e.onended,g=void 0===m?function(){}:m;t(this,n),this.url=o,this.maxChunkSize=c,this.minChunkSize=d,this.onplay=f,this.onpause=v,this.onended=g,this.paused=!0;var x=this;this.audioList=new u.AudioList({onplay:function(){x.paused=!1,x.onplay()},onpause:function(){x.paused=!0,x.onpause()},onended:function(){x.paused=!0,x.onended()}}),this.changeText(s)}return i(n,[{key:"changeText",value:function(n){function e(n){if(n.length<=i.maxChunkSize)return n;for(var e=[];n.length>i.maxChunkSize;)e.push(n.slice(0,i.maxChunkSize)),n=n.slice(i.maxChunkSize);return e.push(n),e}var t=this;if(this.text!==n){this.pause();var i=this;n=n.replace(/<\/?([^>]*)>/g,"$1"),n=n.trim().replace(/\s+/g," ");var u=n.split(/[,;.?!，；。？！]/);u=u.reduce(function(n,t){return n.concat(e(t))},[]),u=u.filter(function(n){return!/^\s*$/.test(n)}),u=u.reduce(function(n,e,t){return t>0&&e.length<i.minChunkSize&&e.length+n[n.length-1].length<i.maxChunkSize?(n[n.length-1]=n[n.length-1]+" "+e,n):n.concat(e)},[]),this.text=n,this.chunkList=u,this.audioList.changeUrlList(this.chunkList.map(function(n){return t.url+encodeURIComponent(n)}))}}},{key:"play",value:function(){this.audioList.play()}},{key:"pause",value:function(){this.audioList.pause()}}]),n}();e.Text2Audio=o});